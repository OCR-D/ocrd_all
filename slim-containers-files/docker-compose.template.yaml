networks:
  default:
    driver: bridge
    driver_opts:
      com.docker.network.driver.mtu: ${OCRD_PS_MTU}

services:
  ocrd-processing-server:
    build:
      context: core
      args:
        BASE_IMAGE: ubuntu:20.04
    ports:
      - ${OCRD_PS_PORT}:8000
    volumes:
      - "./slim-containers-files/ps-config.yaml:/ocrd-processing-server-config.yaml"
    command: ocrd network processing-server -a 0.0.0.0:8000 /ocrd-processing-server-config.yaml

  ocrd-mongodb:
    image: mongo

  ocrd-rabbitmq:
    image: rabbitmq:3-management
    environment:
      environment:
        RABBITMQ_DEFAULT_USER: ${RABBITMQ_USER:-admin}
        RABBITMQ_DEFAULT_PASS: ${RABBITMQ_PASS:-admin}
